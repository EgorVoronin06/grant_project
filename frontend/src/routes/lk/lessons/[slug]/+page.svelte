<script lang="ts">
	import { page } from '$app/state';
	import lessons from '$lib/assets/data/lessons.js';

	let { data } = $props();

	let lessonNumber = $state(1);
	let lesson = $state({ id: 1, title: '', content: '', dactyl: '' });

	$effect(() => {
		lessonNumber = +page.params.slug;
		lesson = lessons[lessonNumber - 1];
	});

	const lessonsCount = lessons.length;
</script>

<div class="lesson-page">
	<div class="lesson-page__bar">
		<div class="lesson-page__wrapper">
			<h2 class="lesson-page__title">{lesson.title}</h2>
			<div class="lesson-page__link-list">
				{#each Array(lessonsCount) as _, i}
					<a href="/lk/lessons/{i + 1}">
						<svg
							class="lesson-page__icon"
							class:lesson-page__icon--done={i < lessonNumber}
							width="36"
							height="36"
							viewBox="0 0 36 36"
							fill="none"
							xmlns="http://www.w3.org/2000/svg"
						>
							<rect x="2" y="2" width="32" height="32" rx="3" stroke="#AAA8A8" stroke-width="4" />
							<path
								d="M27.75 27C28.4404 27 29 27.5596 29 28.25C29 28.9404 28.4404 29.5 27.75 29.5H7.25C6.55964 29.5 6 28.9404 6 28.25C6 27.5596 6.55964 27 7.25 27H27.75Z"
								fill="#0077FF"
							/>
							<path
								d="M27.75 27C28.4404 27 29 27.5596 29 28.25C29 28.9404 28.4404 29.5 27.75 29.5H7.25C6.55964 29.5 6 28.9404 6 28.25C6 27.5596 6.55964 27 7.25 27H27.75Z"
								fill="#D9D9D9"
							/>
							<path
								d="M27.75 27C28.4404 27 29 27.5596 29 28.25C29 28.9404 28.4404 29.5 27.75 29.5H7.25C6.55964 29.5 6 28.9404 6 28.25C6 27.5596 6.55964 27 7.25 27H27.75Z"
								stroke="#0077FF"
							/>
							<path
								d="M7.35938 23.7314C7.36902 23.5889 7.37365 23.583 7.37598 23.5781C7.37868 23.5722 7.40272 23.521 7.55371 23.3877C7.70951 23.2501 7.94709 23.0697 8.31543 22.8037L9.86328 21.708L15.5156 17.7363C16.4064 17.1105 17.2169 16.5378 17.8047 16.1191C18.0982 15.9101 18.3369 15.7386 18.5029 15.6182C18.5857 15.5582 18.6527 15.5094 18.6992 15.4746C18.7216 15.4578 18.7429 15.4421 18.7598 15.4287C18.7672 15.4228 18.7799 15.412 18.793 15.4004C18.7983 15.3956 18.8142 15.3825 18.8311 15.3643C18.8386 15.3562 18.8571 15.3355 18.877 15.3066C18.8869 15.2922 18.9045 15.2655 18.9209 15.2295C18.9344 15.1997 18.9648 15.1243 18.9648 15.0225C18.9648 14.921 18.9346 14.8456 18.9209 14.8154C18.9046 14.7797 18.8869 14.7528 18.877 14.7383C18.8573 14.7098 18.8388 14.689 18.8311 14.6807C18.8141 14.6625 18.7983 14.6483 18.793 14.6436C18.7799 14.632 18.7672 14.6221 18.7598 14.6162C18.7428 14.6027 18.7218 14.5863 18.6992 14.5693C18.6527 14.5345 18.5857 14.4858 18.5029 14.4258C18.3369 14.3054 18.0982 14.1338 17.8047 13.9248L15.5156 12.3076L9.87695 8.3457C8.48035 7.36437 7.83814 6.91333 7.53223 6.63574C7.46125 6.57133 7.42122 6.52734 7.39844 6.49805C7.38785 6.48442 7.38196 6.47499 7.37891 6.46973C7.37741 6.46713 7.37644 6.46485 7.37598 6.46387L7.375 6.46289C7.37326 6.45822 7.36914 6.45436 7.36914 6.28613C7.36914 6.15342 7.38967 6.09552 7.41113 6.05762C7.43063 6.02335 7.46838 5.97547 7.55078 5.90723L7.64941 5.83105C7.70783 5.78937 7.8405 5.72035 7.99414 5.6582C8.06655 5.62893 8.13303 5.60582 8.18457 5.59082C8.24974 5.57188 8.25287 5.57715 8.21777 5.57715C8.29635 5.57715 8.39174 5.56379 8.48535 5.52148C8.49596 5.51668 8.50699 5.50965 8.51953 5.50293C8.53196 5.50254 8.54562 5.50009 8.56055 5.5C8.61453 5.49969 8.67025 5.5018 8.71484 5.50586C8.73663 5.50785 8.75184 5.51019 8.76074 5.51172L8.93262 5.5625L9.1748 5.62305C9.21481 5.63249 9.28089 5.64828 9.58301 5.84082C9.73405 5.93709 9.93228 6.06983 10.2031 6.25488L11.2588 6.98438C12.205 7.64156 14.4152 9.18965 16.5635 10.6982L21.498 14.1738C21.6783 14.3023 21.8548 14.4342 21.9932 14.542C22.0623 14.5958 22.1197 14.642 22.1621 14.6777L22.21 14.7178C22.2355 14.747 22.274 14.8156 22.2949 14.916C22.3053 14.966 22.3083 15.012 22.3076 15.0508L22.2949 15.1436C22.2544 15.2757 22.2612 15.2543 22.2578 15.2588C22.2426 15.2804 22.1873 15.3455 21.9775 15.5107C21.7714 15.6731 21.4589 15.9006 20.9746 16.2441L18.9404 17.6738L13.21 21.6963C11.1196 23.1635 10.1307 23.8605 9.5752 24.2012C9.30002 24.3699 9.1657 24.4288 9.0791 24.4551C9.01886 24.4733 8.97267 24.4791 8.87988 24.4863L8.84863 24.4814C8.78867 24.4752 8.71515 24.4717 8.6416 24.4717L8.43555 24.4814L8.42285 24.4834C8.22905 24.4594 8.03601 24.4073 7.86426 24.3281C7.65536 24.2319 7.51316 24.1177 7.43164 24.0166L7.37012 23.9209C7.37633 23.9341 7.37616 23.937 7.37305 23.9248C7.37032 23.9142 7.36622 23.8972 7.36328 23.875L7.35938 23.7314ZM8.80469 5.03809C8.80469 5.07428 8.7984 5.1075 8.79199 5.13867C8.79825 5.1071 8.80469 5.07387 8.80469 5.03809ZM8.78516 5.1709C8.78087 5.18627 8.77595 5.20082 8.77051 5.21484C8.77572 5.20063 8.78106 5.18625 8.78516 5.1709Z"
								fill="#D9D9D9"
								stroke="#0077FF"
							/>
						</svg>
						<span class="visually-hidden">{i + 1}</span>
					</a>
				{/each}
			</div>
		</div>
	</div>
	<div class="lesson-page__content">
		{#if lesson.content}
			<p class="lesson-page__text">
				{lesson.content}
			</p>
			<img
				class="lesson-page__dactyl-image"
				style="width: 100%;"
				src={lesson?.image}
				alt="Дактиль {lesson.dactyl}"
			/>
		{/if}
		{#if lesson.dactyl}
			<p class="lesson-page__dactyl">{lesson.dactyl}</p>
			<img class="lesson-page__dactyl-image" src={lesson?.image} alt="Дактиль {lesson.dactyl}" />
			<video src="/images/a-video.mp4"></video>
		{/if}
	</div>
</div>

<style>
	.lesson-page {
		display: flex;
		flex-direction: column;
		gap: 10px;
		height: 100%;
	}

	.lesson-page__title {
		margin-bottom: 10px;
		font-size: 18px;
	}
	.lesson-page__bar {
		background: white;
		border-radius: 10px;
		display: flex;
		align-items: center;
		justify-content: space-between;
		padding: 10px;
		border: 1px solid var(--color-primary-transparent);
	}
	.lesson-page__content {
		display: grid;
		font-size: 18px;
		background-color: var(--color-white);
		border-radius: 10px;
		/* grid-template-columns: repeat(3, 1fr); */
		/* gap: 70px; */
		padding: 35px 35px;
		flex-grow: 1;
	}

	.lesson-page__icon--done {
		fill: var(--color-primary);
	}
</style>
